{% extends "base.html" %}
{% load static %}

{% block content %}
<section class="container my-5">
  <h2 class="mb-4 text-center">Review Your Order</h2>

  <!-- Contact Details -->
  <div class="mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <h4>Contact Details</h4>
      <a href="/checkout/" class="btn btn-link">Change</a>
    </div>
    <p>{{ contact_info.first_name }} {{ contact_info.last_name }}<br>{{ contact_info.email }}</p>
  </div>

  <!-- Billing Info -->
  <div class="mb-4">
    <div class="d-flex justify-content-between align-items-center">
      <h4>Billing Information</h4>
      <a href="/checkout/" class="btn btn-link">Change</a>
    </div>
    <p>
      {{ billing_info.billing_street1 }}<br>
      {% if billing_info.billing_street2 %}{{ billing_info.billing_street2 }}<br>{% endif %}
      {{ billing_info.billing_city }}, {{ billing_info.billing_county }}<br>
      {{ billing_info.billing_postcode }} {{ billing_info.billing_country }}<br>
      {{ billing_info.billing_phone }}
    </p>
  </div>

  <!-- Order Items -->
  <div class="mb-4">
    <h4>Your Order</h4>
    <ul class="list-group">
      {% for item in bag_items %}
        <li class="list-group-item d-flex justify-content-between">
          <div>
            <strong>{{ item.product.title }}</strong><br>
            {{ item.format|title }}{% if item.license %} ({{ item.license }}){% endif %}{% if item.print_type %} - {{ item.print_type }}{% endif %}
          </div>
          <div>x{{ item.quantity }}</div>
        </li>
      {% endfor %}
    </ul>
  </div>

  <!-- Special Offer -->
  {% if special_offer %}
    <div class="alert alert-success">
      <strong>Discount Applied:</strong> {{ special_offer.text }}
    </div>
  {% endif %}

  <!-- Order Total -->
  <div class="mt-4">
    <h4>Order Summary</h4>
    <ul class="list-group">
      <li class="list-group-item d-flex justify-content-between">
        <span>Subtotal</span>
        <strong>€{{ bag_total }}</strong>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>VAT ({{ vat_rate_display }}%)</span>
        <strong>€{{ vat }}</strong>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>Shipping</span>
        <strong>€{{ shipping_total }}</strong>
      </li>
      <li class="list-group-item d-flex justify-content-between">
        <span>Total</span>
        <strong>€{{ grand_total }}</strong>
      </li>
    </ul>
  </div>

  <div class="text-end mt-4">
    <a href="/checkout/payment/" class="btn btn-primary px-4 py-2">Proceed to Payment</a>
  </div>
</section>
{% endblock %}
